Content-type: text/html

<HTML><HEAD><TITLE>Manpage of FW1-LOGGRABBER</TITLE>
</HEAD><BODY>
<H1>FW1-LOGGRABBER</H1>
Section: Misc. Reference Manual Pages (September 2004)<BR>Updated: Unix<BR><A HREF="#index">Index</A>
<A HREF="http://localhost/cgi-bin/man/man2html">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

fw1-loggrabber - a command line LEA-client for Checkpoint FW-1
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>fw1-loggrabber [--options]</B>

<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<B>fw1-loggrabber</B>

is a commandline LEA client is a command-line LEA-client for Checkpoint FW-1. 
Using this tool, it's possible to get FW-1 logging data from remote using
Checkpoints proprietary LEA protocol, which is a part of their OPSEC API. 
The idea for <B>fw1-loggrabber</B> was born due to the need of analysing 
Checkpoint FW-1 log data using LIRE (<A HREF="http://www.logreport.org).">http://www.logreport.org).</A> Meanwhile
their are a lot of additional features, which hopefully ease daily work
of many firewall administrators.
<A NAME="lbAE">&nbsp;</A>
<H2>PREREQUISITES</H2>

<B>fw1-loggrabber</B> is statically linked and runs on the following platforms. If you run <B>fw1-loggrabber</B> on another distribution, version or kernel version, please send me a mail describing your environment.
<DL COMPACT><DT><DD>
<P>
- Linux - tested distributions are Red Hat, SuSE and Debian with Kernel 2.2.x and 2.4.x (for experimental MySQL-support, the MySQL-Client and Zlib rpm must
be installed).
</DL>

<DL COMPACT><DT><DD>
<P>
- Solaris SPARC - tested versions are Solaris 2.7, 8 and 9.
</DL>

<DL COMPACT><DT><DD>
<P>
- Windows NT/2000/XP - tested versions are currently only Windows 2000
</DL>

<A NAME="lbAF">&nbsp;</A>
<H2>OPTIONS</H2>

In the following lines, all available command line options are described in detail. Most
of the options can also be configured using the configuration file <B>fw1-loggrabber.conf</B>
(see <B>--configfile</B> option to use a different configuration file). The precedence of given
options is as follows: commandline, configuration file, default value. E.g. if you set the 
portnumber to be used to 50000 in the configuration file, this can be overwritten by 
commandline option <B>--port</B>. Only if an option isn't set neither on commandline nor in
the configuration file, the default value will be used.
<DL COMPACT>
<DT><B>-p &lt;portnumber&gt;, --port &lt;portnumber&gt;</B>

<DD>
The <B>-p</B> respectively the <B>--port</B> option can be used to specify a non-default
port to connect to the FW-1 management station. If this option is used, the configuration
file parameter <B>FW1_PORT</B> will not be used.
<DT><B>-s &lt;servername&gt;, --server &lt;servername&gt;</B>

<DD>
Using one of these options, the name or ip address of the FW1 management station,
to which <B>fw1-loggrabber</B> should connect to, can be specified on command line.
If this option is used, the configuration file parameter <B>FW1_SERVER</B> will not be used.
<DT><B>-f &lt;logfilename|pattern|ALL&gt;, --logfile &lt;logfilename|pattern&gt;</B>

<DD>
With these parameters, the name of the FW-1 logfile to be read, can be specified. This
can be either done exactly or using only a part of the filename. If no exact match can
be found in the list of logfiles returned by the FW-1 management station, all logfiles
which contain the specified string are processed. A special case is the usage of <B>ALL</B>
instead of a logfile name or pattern. In that case all logfiles that are available
on the management station, will be processed. If this parameter is omitted, only the default
logfile fw.log will be processed. E.g.
<DL COMPACT><DT><DD>
<P>
--logfile 2003-03-27_213652.log
</DL>

<DL COMPACT><DT><DD>
--logfile 2003-03
</DL>

<DL COMPACT><DT><DD>
<P>
The first example display the logfile 2003-03-27_213652.log, the second one processes
all logfiles which contain 2003-03 in their filename.
</DL>

<DT><B>-c &lt;configfilename&gt;, --configfile &lt;configfilename&gt;</B>

<DD>
These options allow to specify a non-default configuration file, in which most
of the commandline options can be configured as well as other options, which are
not available as commandline parameters. If this parameter is omitted, the file 
<B>fw1-loggrabber.conf</B> in the current directory will be used. See below for a
description of all available configuration file options.
<DT><B>--resolve</B>

<DD>
Using the <B>--resolve</B> option, IP addresses will be resolved to names using 
FW-1 name resolving behaviour. This resolving mechanism will not cause the machine
running <B>fw1-loggrabber</B> to initiate DNS requests, but the name resolution will
be done directly on the FW-1 machine. Enabled name resolution is also the default 
behaviour of <B>fw1-loggrabber</B>.
<DT><B>--noresolve</B>

<DD>
In contrast to <B>--resolve</B>, the option <B>--no-resolve</B> will cause IP addresses
to be displayed in log output instead of names.
<DT><B>--showfiles</B>

<DD>
The option <B>--showfiles</B> can be used to simply show the available logfiles on
the FW-1 management station. After the names of the logfiles have been displayed,
<B>fw1-loggrabber</B> quits.
<DT><B>--showlogs</B>

<DD>
The default behaviour of <B>fw1-loggrabber</B> is to 
display the content of the logfiles and not just their names. This can be explicitely
specified using the <B>--showlogs</B> option.
<DT><B>--auth    </B>

<DD>
If you want to use authenticated connections for reading the logfiles, you have to 
use the <B>--auth</B> parameter. In that case you have also configure the FW-1 
management station as well as the FW-1 policy and your local configuration file in order 
to successfully connect to the FW-1 server. Within the configuration file you
can also specify the authentication/encryption algorithm to be used for connecting. 
<DT><B>--no-auth</B>

<DD>
For unauthenticated connections use the 
<B>--no-auth</B> option, here you only have to configure your FW-1 management station
in order to allow unauthenticated connections. But for security reasons you should 
always use authenticated connections.
<DT><B>--2000</B>

<DD>
The option <B>--2000</B> has to be used if you want to connect to CP FW-1 4.1 (2000) 
firewalls. You have to consider, that some options are not available for non-NG 
firewalls. These include <B>--auth</B>, <B>--showfiles</B>, <B>--auditlog</B> and 
some other options.
<DT><B>--ng</B>

<DD>
The default FW-1 version, for which this tool is being developed, is CP FW-1 5.0 (NG), 
which is the default version, is no version is explicitely specified.
<DT><B>--online</B>

<DD>
Using online mode, <B>fw1-loggrabber</B> starts output of logging data at the end of 
the specified logfile (or fw.log if no logfilename has been specified). All future 
log entries will be displayed. If you use <B>--logfile</B> to specify another logfile
to be processed, you have to consider that no data will be shown, if the file isn't
active anymore. This mode is mainly used for continuously processing FW-1 log data 
and continues to display log entries also after scheduled and manual log switches.
<DT><B>--no-online</B>

<DD>
In contrast to online mode, <B>fw1-loggrabber</B> quits after having displayed the last
log entry, when running in offline mode. This is the default behaviour and is mainly
used for analysis of historic log data.
<DT><B>--auditlog</B>

<DD>
Using the audit mode, content of the audit logfile (fw.adtlog) can be displayed. This 
includes administrator actions and uses different fields than normal log data.
<DT><B>--normallog</B>

<DD>
The default mode of <B>fw1-loggrabber</B> processes normal FW-1 logfiles. In contrast 
to the <B>--auditlog</B> option, no admistration actions are displayed in this mode, but
all regular log data.
<DT><B>--filter ``&lt;filterexpression1&gt;[;&lt;filterexpression2&gt;]''</B>

<DD>
Using one or multiple <B>--filter</B> options, you are able to filter log entries in 
order to see only entries which match your filter rules. You can specify multiple 
filter rules using multiple <B>--filter</B> options. All filter rules are related by
OR, i.e. if you specify multiple rules, a log entry will be displayed if one of the
rules matches. Within one filter rule, you can specify multiple arguments. All of these
arguments are related by AND, i.e. a single filter rule only matches a given log entry
if the log entry is matched by all arguments. A more detailed description of filter rules
you can find below in a separate chapter about filtering which also provides various examples.
<DT><B>--fields ``&lt;field1&gt;[;&lt;field2&gt;]''</B>

<DD>
The <B>--fields</B> option can be used to display only a given set of fields
instead of displaying all available fields. The order of the fields is 
always the same despite the order of the fields specified with the <B>--fields</B>
option. E.g.
<DL COMPACT><DT><DD>
<P>
--fields &quot;loc;src;dst&quot;
</DL>

<DL COMPACT><DT><DD>
<P>
You can display the currently supported fields with the <B>--help-fields</B> option.
If you are missing some fields, please run <B>fw1-loggrabber</B> with <B>--debug-level 1</B> 
and check for debug output containing <I>&quot;Unsupported field found: fieldname=fieldvalue&quot;</I>.
If you send me these lines I will implement the missing fields in the next release.
</DL>

<DT><B>--fieldnames</B>

<DD>
Using the <B>--fieldnames</B> option the name of each field will be prepended to
each value in each line of <B>fw1-loggrabber</B> output. E.g.  
<DL COMPACT><DT><DD>
<BR>&nbsp;
loc=42|src=1.2.3.4|dst=4.3.2.1 
</DL>

<DT><B>--nofieldnames</B>

<DD>
In contrast to the <B>--fieldnames</B> option, the usage of this option will cause
fieldnames to be displayed in the first line of output only. All the following output
lines contain only the fieldvalues separated by '|' or by a user defined separator. E.g.
<DL COMPACT><DT><DD>
<P>
loc|src|dst
</DL>

<DL COMPACT><DT><DD>
42|1.2.3.4|4.3.2.1
</DL>

<DT><B>--mysql </B>

<DD>
EXPERIMENTAL! This option enables mysql-mode for storing log data in a MySQL database.
In order to support more databases and my unwillingness to deal with MS-SQL or Oracle
APIs, this feature will be replaced in on of the following versions by a Perl wrapper 
script, which supports multiple database systems.
<DT><B>--no-mysql</B>

<DD>
This option just disables the mysql-mode and forces <B>fw1-loggrabber</B> to use the 
default output method for log data.
<DT><B>--debuglevel &lt;0-3&gt;</B>

<DD>
Sets the debuglevel to the specified value. A debuglevel of 0 means no output of
debug informations. Further debuglevels will cause output of program specific as well
as OPSEC specific debug informations.
<DT><B>--help</B>

<DD>
Use <B>--help</B> to display basic help and usage information. For further help, please
refer to the man page.
<DT><B>--help-fields</B>

<DD>
This option just displays all fieldnames which are currently supported by 
<B>fw1-loggrabber</B> for both normal logfiles and audit logfiles.
</DL>
<A NAME="lbAG">&nbsp;</A>
<H2>CONFIGURATION FILE</H2>

This paragraph deals with the options that can be set within the configuration file.
The default configuration file is <B>fw1-loggrabber.conf</B> which should be in the 
current directory. (see <B>--configfile</B> option to use a different configuration file). 
The precedence of given
options is as follows: commandline, configuration file, default value. E.g. if you set the 
portnumber to be used to 50000 in the configuration file, this can be overwritten by 
commandline option <B>--port</B>. Only if an option isn't set neither on commandline nor in
the configuration file, the default value will be used.
<DL COMPACT>
<DT><B>DEBUG_LEVEL=&lt;0-3&gt;</B>

<DD>
Sets the debuglevel to the specified value. A debuglevel of 0 means no output of
debug informations. Further debuglevels will cause output of program specific as well
as OPSEC specific debug informations. This parameter can be overwritten by 
<B>--debug-level</B> command-line option.
<DT><B>MYSQL_MODE={yes|YES|no|NO}</B>

<DD>
EXPERIMENTAL! This option enables or disables mysql-mode for storing log data in a MySQL database.
In order to support more databases and my unwillingness to deal with MS-SQL or Oracle
APIs, this feature will be replaced in on of the following versions by a Perl wrapper 
script, which supports multiple database systems. The correspondent command-line parameters
are <B>--mysql</B> and <B>--no-mysql</B>.
<DT><B>MYSQL_HOST=&lt;Hostname of MySQL-Server&gt;</B>

<DD>
EXPERIMENTAL! If mysql-mode is used, the name or the ip address of the MySQL-server
has to be specified using this option.
<DT><B>MYSQL_USER=&lt;Username for MySQL-Database&gt;</B>

<DD>
EXPERIMENTAL! If mysql-mode is used, the username for the MySQL-database
has to be specified using this option.
<DT><B>MYSQL_PASSWORD=&lt;Password for MySQL-Database&gt;</B>

<DD>
EXPERIMENTAL! If mysql-mode is used, the password for the MySQL-database
has to be specified using this option.
<DT><B>MYSQL_DATABASE=&lt;Database-Name of MySQL-Database&gt;</B>

<DD>
EXPERIMENTAL! If mysql-mode is used, the name of the MySQL-database
has to be specified using this option.
<DT><B>FW1_SERVER=&lt;IP address of FW1-Management Station&gt;</B>

<DD>
With this option, the name or ip address of the FW1 management station,
to which <B>fw1-loggrabber</B> should connect to, can be specified.
The correspondent command-line parameter is <B>--server</B>.
<DT><B>FW1_PORT=&lt;Port number for LEA connections&gt;</B>

<DD>
This option can be used to specify a non-default
port to connect to the FW-1 management station.
The correspondent command-line parameter is <B>--port</B>.
<DT><B>FW1_LOGFILE=&lt;Name of FW1-Logfilename&gt;</B>

<DD>
With this parameter, the name of the FW-1 logfile to be read, can be specified. This
can be either done exactly or using only a part of the filename. If no exact match can
be found in the list of logfiles returned by the FW-1 management station, all logfiles
which contain the specified string are processed. If this parameter is omitted, the default
logfile fw.log will be processed.
The correspondent command-line parameter is <B>--logfile</B>.
<DT><B>FW1_OUTPUT=&lt;files|logs&gt;</B>

<DD>
This parameter simply specifies whether <B>fw1-loggrabber</B> should only display the 
available logfiles (files) on the FW-1 server or display the content of the logfiles (logs).
The correspondent command-line parameters are <B>--showfiles</B> and <B>--showlogs</B>.
<DT><B>FW1_TYPE=&lt;NG|ng|2000&gt;</B>

<DD>
Using this parameter you can choose to which version of FW-1 to connect to. For Checkpoint
FW-1 5.0 (NG) you have to specify NG and for Checkpoint FW-1 4.1 (2000) you have to specify 2000.
The correspondent command-line parameters are <B>--2000</B> and <B>--ng</B>.
<DT><B>FW1_MODE=&lt;audit|AUDIT|normal|NORMAL&gt;</B>

<DD>
This parameter enables you to specify whether to display audit logs which contain 
administrative actions of normal security logs, which contain data about dropped and 
accepted connections.
The correspondent command-line parameters are <B>--auditlog</B> and <B>--normallog</B>.
<DT><B>ONLINE_MODE=&lt;yes|YES|no|NO&gt;</B>

<DD>
Using online mode, <B>fw1-loggrabber</B> starts output of logging data at the end of 
the specified logfile (or fw.log if no logfilename has been specified). All future 
log entries will be displayed. If you use <B>--logfile</B> to specify another logfile
to be processed, you have to consider that no data will be shown, if the file isn't
active anymore. This mode is mainly used for continuously processing FW-1 log data.
If you disable online mode, <B>fw1-loggrabber</B> quits after having displayed the last
log entry. This is the default behaviour and is mainly
used for analysis of historic log data.
The correspondent command-line parameters are <B>--online</B> and <B>--no-online</B>.
<DT><B>RESOLVE_MODE=&lt;yes|YES|no|NO&gt;</B>

<DD>
With this option, IP addresses will be resolved to names using 
FW-1 name resolving behaviour. This resolving mechanism will not cause the machine
running <B>fw1-loggrabber</B> to initiate DNS requests, but the name resolution will
be done directly on the FW-1 machine. Enabled name resolution is also the default 
behaviour of <B>fw1-loggrabber</B>.
If you disable resolving mode this will cause IP addresses
to be displayed in log output instead of names.
The correspondent command-line parameters are <B>--resolve</B> and <B>--no-resolve</B>.
<DT><B>SHOW_FIELDNAMES=&lt;yes|YES|no|NO&gt;</B>

<DD>
Using this option can be chosen, whether the name of each field should be displayed i
in each line of log output (YES) of just in the first line of output.
The correspondent command-line parameters are <B>--fieldnames</B> and <B>--nofieldnames</B>.
<DT><B>RECORD_SEPARATOR=&lt;char&gt;</B>

<DD>
This parameter can be used to change the default record separator (|) into another character.
If you choose a character which is contained in some log data, the occurrence within the 
logdata will be escaped by a backslash.
<DT><B>DATEFORMAT=&lt;CP|UNIX|STD&gt;</B>

<DD>
Using the <B>DATEFORMAT</B> option, you can choose between three different date formats 
for output of date fields. The value <B>CP</B> provides the standard Checkpoing date
format ( 3Feb2004 14:15:16). Using the values <B>UNIX</B> or <B>STD</B> you can change 
this into standard Unix time format (1051655431) or into a standardized human-readable
format (2004-02-03 14:15:16).
<DT><B>LOGGING_CONFIGURATION=&lt;screen|file|syslog&gt;</B>

<DD>
The <B>LOGGING_CONFIGURATION</B> parameter can be used for redirection of logging output to
other destinations than the default destination STDOUT, i.e. screen. Currently it's possible
to redirect output to a file or to syslog daemon (Unix only). Using the parametes 
<B>OUTPUT_FILE_PREFIX</B> and <B>OUTPUT_FILE_ROTATESIZE</B>, you can specify more details,
if you choose to redirect the output to a file.
<DT><B>OUTPUT_FILE_PREFIX=&lt;prefix of output file&gt;</B>

<DD>
This parameter can be used to define a prefix for the output filename. Eventually the output 
file will get the suffix <B>.log</B> respectively a datestamp when it gets rotated. The
default value for this prefix is simply <B>fw1-loggrabber</B>. This parameter will only be 
used if <B>LOGGING_CONFIGURATION</B> is set to <B>file</B>.
<DT><B>OUTPUT_FILE_ROTATESIZE=&lt;rotatesize in bytes&gt;</B>

<DD>
Using this parameter you can specify the maximum size of the output files, before they will
be rotated. If the size of the output file exceeds the given value, the logfile will be rotated
to &lt;OUTPUT_FILE_PREFIX&gt;-YYYY-MM-DD-hhmmss[-x].log. The default value is 1048576 bytes, 
which equals 1 megabyte. It should be obvious
that this parameter will only be used if <B>LOGGING_CONFIGURATION</B> is set to <B>file</B>.
<DT><B>AUTHENTICATED={yes|YES|no|NO}</B>

<DD>
If you want to use authenticated connections for reading the logfiles, you have to 
use set parameter to YES. In that case you have also configure the FW-1 
management station as well as the FW-1 policy and your local configuration file in order 
to successfully connect to the FW-1 server. Within the configuration file you
can also specify the authentication/encryption algorithm to be used for connecting.
For security reasons it's generally recommended to use authenticated connections to
connect <B>fw1-loggrabber</B> to FW-1 servers.
The correspondent command-line parameters are <B>--auth</B> and <B>--no-auth</B>.
<DT><B>AUTHENTICATION_TYPE=&lt;authtype value&gt;</B>

<DD>
For authenticated connections to FW-1 servers one of the following authentication 
method can be used: SSLCA, SSLCA_COMP, SSLCA_RC4, SSLCA_RC4_COMP, ASYM_SSLCA, ASYM_SSLCA_COMP, 
ASYM_SSLCA_RC4, ASYM_SSLCA_RC4_COMP or SSLCA_CLEAR. You have to consider that your FW-1 server
must also be configured in order to be able to use the chosen authentication method.
<DT><B>OPSEC_CERTIFICATE=&lt;Path and Name of Opsec Certificate&gt;</B>

<DD>
Use this option to specify path and name of the PKCS#12 certificate which you pull
from your FW-1 management server when initializing Secure Internal Communication (SIC).
<DT><B>OPSEC_CLIENT_DN=&lt;DN of Opsec-Client&gt;</B>

<DD>
This option has to be used to specify the distinguished name of the client object for 
<B>fw1-loggrabber</B>, which has to be defined in your FW-1 policy prior to be able
to use authenticated connections.
<DT><B>OPSEC_SERVER_DN=&lt;DN of Opsec-Server&gt;</B>

<DD>
Here you can specify the distinguished name of your FW-1 server, to which <B>fw1-loggrabber</B>
connects to. You can find this distinguished name in the properties of the server object
in your FW-1 policy.
</DL>
<A NAME="lbAH">&nbsp;</A>
<H2>CONFIGURE FW-1</H2>

For both authenticated and unauthenticated connections of <B>fw1-loggrabber</B> to  
FW-1 servers there is the need for additional configuration on both the FW-1 side and
the <B>fw1-loggrabber</B> side. This section describes the necessary steps to successfully
establish a connection.
<DL COMPACT>
<DT><B>Configuration of unauthenticated connections</B>

<DD>
<DL COMPACT><DT><DD>
<I>Configuration of FW-1 server:</I>
</DL>

<DL COMPACT><DT><DD>
<P>
- modify $FWDIR/conf/fwopsec.conf and define the port to be used for unauthenticated
lea connections:
</DL>

<DL COMPACT><DT><DD>
<DL COMPACT><DT><DD>
lea_server    port    50001
</DL>

</DL>

<DL COMPACT><DT><DD>
<P>
- bounce FW-1 in order to activate changes
</DL>

<DL COMPACT><DT><DD>
<DL COMPACT><DT><DD>
cpstop ; cpstart
</DL>

</DL>

<DL COMPACT><DT><DD>
<P>
<I>Configuration of FW-1 policy:</I>
</DL>

<DL COMPACT><DT><DD>
<P>
- add a rule to the policy to allow the port defined above from the <B>fw1-loggrabber</B>
machine to the FW-1 management server.
</DL>

<DL COMPACT><DT><DD>
<P>
- install the policy
</DL>

<DL COMPACT><DT><DD>
<P>
<I>Configuration of fw1-loggrabber:</I>
</DL>

<DL COMPACT><DT><DD>
<P>
- use the <B>--port</B> command-line option or the FW1_PORT configuration file
parameter to specify the port you defined on your FW-1 server.
</DL>

<DT><B>Configuration of authenticated connections</B>

<DD>
<DL COMPACT><DT><DD>
<I>Configuration of FW-1 server:</I>
</DL>

<DL COMPACT><DT><DD>
<P>
- modify $FWDIR/conf/fwopsec.conf and define the port to be used for authenticated
lea connections as well as the authentication algorithm. The default algorithm for 
authenticated connections is SSLCA:
</DL>

<DL COMPACT><DT><DD>
<DL COMPACT><DT><DD>
lea_server    auth_port    18184
</DL>

<DL COMPACT><DT><DD>
lea_server    auth_type    sslca
</DL>

</DL>

<DL COMPACT><DT><DD>
<P>
- bounce FW-1 in order to activate changes
</DL>

<DL COMPACT><DT><DD>
<DL COMPACT><DT><DD>
cpstop ; cpstart
</DL>

</DL>

<DL COMPACT><DT><DD>
<P>
<I>Configuration of FW-1 policy:</I>
</DL>

<DL COMPACT><DT><DD>
<P>
- create a new Opsec Application Object with the following details:
</DL>

<DL COMPACT><DT><DD>
<DL COMPACT><DT><DD>
- Name:            e.g. Loggrabber
</DL>

<DL COMPACT><DT><DD>
- Vendor:          User Defined
</DL>

<DL COMPACT><DT><DD>
- Server Entities: None
</DL>

<DL COMPACT><DT><DD>
- Client Entities: LEA
</DL>

</DL>

<DL COMPACT><DT><DD>
<P>
- initialize Secure Internal Communication (SIC) for recently created 
Opsec Application Object and enter (and remember) the initial password.
</DL>

<DL COMPACT><DT><DD>
<P>
- write down the DN of the recently created Opsec Application Object. This is your
Client Distinguished Name, which you need later on.
</DL>

<DL COMPACT><DT><DD>
<P>
- open the object of your FW-1 management server and write down the DN of that object.
This is the Server Distinguished Name, which you will need later on.
</DL>

<DL COMPACT><DT><DD>
<P>
- add a rule to the policy to allow the port defined above as well as port 18210/tcp 
(FW1_ica_pull) in order to allow pulling of PKCS#12 certificate from the <B>fw1-loggrabber</B>
machine to the FW-1 management server. The port 18210/tcp can be shut down after the 
communication between <B>fw1-loggrabber</B> and the FW-1 management server has been established
successfully.
</DL>

<DL COMPACT><DT><DD>
<P>
- install the policy
</DL>

<DL COMPACT><DT><DD>
<P>
<I>Configuration of fw1-loggrabber:</I>
</DL>

<DL COMPACT><DT><DD>
<P>
- get the tool opsec_pull_cert either from opsec-tools.tar.gz from the project
home page or directly from the OPSEC SDK. This tool is needed to establish the
Secure Internal Communication (SIC) between <B>fw1-loggrabber</B> and the FW-1
management server.
</DL>

<DL COMPACT><DT><DD>
<P>
- execute the command opsec_pull_cert as follows and copy the resulting PKCS#12
file (default: opsec.p12) to your <B>fw1-loggrabber</B> directory.
</DL>

<DL COMPACT><DT><DD>
<DL COMPACT><DT><DD>
opsec_pull_cert \
</DL>

<DL COMPACT><DT><DD>
<BR>&nbsp;&nbsp;-h&nbsp;&lt;IP&nbsp;of&nbsp;FW-1&nbsp;Management&nbsp;Server&gt;&nbsp;\
</DL>

<DL COMPACT><DT><DD>
<BR>&nbsp;&nbsp;-n&nbsp;&lt;Name&nbsp;of&nbsp;Opsec&nbsp;Application&nbsp;Object&gt;&nbsp;\
</DL>

<DL COMPACT><DT><DD>
<BR>&nbsp;&nbsp;-p&nbsp;&lt;Password&nbsp;you&nbsp;entered&nbsp;before&nbsp;in&nbsp;policy&gt;
</DL>

</DL>

<DL COMPACT><DT><DD>
<P>
- use the <B>--port</B> command-line option or the FW1_PORT configuration file
parameter to specify the port you defined on your FW-1 server.
</DL>

<DL COMPACT><DT><DD>
<P>
- edit the <B>AUTHENTICATION_TYPE</B> configuration file parameter according to 
the authentication type, that you have configured previously on your FW-1 
management server.
</DL>

<DL COMPACT><DT><DD>
<P>
- edit the <B>OPSEC_CERTIFICATE</B> configuration file parameter according to 
the name of the PKCS#12 file which you created before using the opsec_pull_cert
command.
</DL>

<DL COMPACT><DT><DD>
<P>
- edit the <B>OPSEC_CLIENT_DN</B> configuration file parameter according to 
the Client DN, that you have written down before.
</DL>

<DL COMPACT><DT><DD>
<P>
- edit the <B>OPSEC_SERVER_DN</B> configuration file parameter according to 
the Server DN, that you have written down before.
</DL>

</DL>
<A NAME="lbAI">&nbsp;</A>
<H2>FILTERING</H2>

Filter rules provide the possibility to display only log entries that
match a given set of rules. There can be specified one or more filter 
rules using one or multiple <B>--filter</B> arguments on the command 
line. All individual filter rules are related by OR. That means a log
entry will be displayed if at least one of the filter rules matches.
Within one filter rule, there can be specified multiple arguments. All 
these arguments are related by AND. That means a filter rule matches a
given log entry only, if all of the filter arguments match.
<DL COMPACT>
<DT><B>Supported filter arguments in normal mode</B>

<DD>
<DL COMPACT><DT><DD>
- action=&lt;accept|drop|reject&gt;
</DL>

<DL COMPACT><DT><DD>
- dst=&lt;IP address&gt;
</DL>

<DL COMPACT><DT><DD>
- endtime=&lt;YYYYMMDDhhmmss&gt;
</DL>

<DL COMPACT><DT><DD>
- product=&lt;VPN-1 &amp; FireWall-1|SmartDefense&gt;
</DL>

<DL COMPACT><DT><DD>
- proto=&lt;icmp|tcp|udp&gt;
</DL>

<DL COMPACT><DT><DD>
- rule=&lt;rulenumber|startrule-endrule&gt;
</DL>

<DL COMPACT><DT><DD>
- service=&lt;portnumber|startport-endport&gt;
</DL>

<DL COMPACT><DT><DD>
- src=&lt;IP address&gt;
</DL>

<DL COMPACT><DT><DD>
- starttime=&lt;YYYYMMDDhhmmss&gt;
</DL>

<DT><B>Supported filter arguments in audit mode</B>

<DD>
<DL COMPACT><DT><DD>
- action=&lt;accept|drop|reject&gt;
</DL>

<DL COMPACT><DT><DD>
- administrator=&lt;string&gt;
</DL>

<DL COMPACT><DT><DD>
- endtime=&lt;YYYYMMDDhhmmss&gt;
</DL>

<DL COMPACT><DT><DD>
- product=&lt;SmartDashboard|Policy Editor|SmartView Tracker|SmartView Status|SmartView Monitor|System Monitor|cpstat_monitor|SmartUpdate|CPMI Client&gt;
</DL>

<DL COMPACT><DT><DD>
- starttime=&lt;YYYYMMDDhhmmss&gt;
</DL>

<DT><B>Negation of arguments</B>

<DD>
If you specify '!=' instead of '=' between name and value
of the filter argument, you can negate the name/value pair.
<DT><B>Specifying multiple argument values</B>

<DD>
You can specify multiple argument values by separating the
values by ','.
<DT><B>Specifying IP addresses as argument values</B>

<DD>
For arguments that expect IP addresses, you can specify either
a single IP address, multiple IP addresses separated by ',' or
a network address with netmask (e.g. 10.0.0.0/255.0.0.0). Currently
it's not possible to specify a network address and a single IP
address within the same filter argument.
<DT><B>Specifying multiple filter arguments</B>

<DD>
Each filter rule can exist of multiple filter arguments which have
to be separated by ';'.
<DT><B>Examples</B>

<DD>
<DL COMPACT><DT><DD>
1) display all dropped connections
</DL>

<DL COMPACT><DT><DD>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;--filter&nbsp;&quot;action=drop&quot;
</DL>

<DL COMPACT><DT><DD>
<P>
2) display all dropped and rejected connections
</DL>

<DL COMPACT><DT><DD>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;--filter&nbsp;&quot;action=drop,reject&quot;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;--filter&nbsp;&quot;action!=accept&quot;
</DL>

<DL COMPACT><DT><DD>
<P>
3) display all log entries generated by rules 20 to 23
</DL>

<DL COMPACT><DT><DD>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;--filter&nbsp;&quot;rule=20,21,22,23&quot;
<BR>&nbsp;&nbsp;&nbsp;&nbsp;--filter&nbsp;&quot;rule=20-23&quot;
</DL>

<DL COMPACT><DT><DD>
<P>
4) display all log entries generated by rules 20 to 23, 30 or 40 to 42
</DL>

<DL COMPACT><DT><DD>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;--filter&nbsp;&quot;rule=20-23,30,40-42&quot;
</DL>

<DL COMPACT><DT><DD>
<P>
5) display all log entries to 10.1.1.1 and 10.1.1.2
</DL>

<DL COMPACT><DT><DD>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;--filter&nbsp;&quot;dst=10.1.1.1,10.1.1.2&quot;
</DL>

<DL COMPACT><DT><DD>
<P>
6) display all log entries from 192.168.1.0/255.255.255.0
</DL>

<DL COMPACT><DT><DD>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;--filter&nbsp;&quot;src=192.168.1.0/255.255.255.0&quot;
</DL>

<DL COMPACT><DT><DD>
<P>
7) display all log entries starting from 2004/03/02 14:00:00
</DL>

<DL COMPACT><DT><DD>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;--filter&nbsp;&quot;starttime=20040302140000&quot;
</DL>

</DL>
<A NAME="lbAJ">&nbsp;</A>
<H2>FILES</H2>

<I>fw1-loggrabber.conf</I>

<A NAME="lbAK">&nbsp;</A>
<H2>AUTHOR</H2>

Torsten Fellhauer &lt;torsten at fellhauer dash web dot net&gt;
<A NAME="lbAL">&nbsp;</A>
<H2>BUGS</H2>

Please report bugs using the bug report functionality on the projects 
website: 
<DL COMPACT><DT><DD>
<I><A HREF="http://sourceforge.net/projects/fw1-loggrabber">http://sourceforge.net/projects/fw1-loggrabber</A></I>
</DL>

<A NAME="lbAM">&nbsp;</A>
<H2>COPYRIGHT</H2>

Copyright (c) 2003-2004 Torsten Fellhauer, Xiaodong Lin
<P>

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:
<P>

1. Redistributions of source code must retain the 
<BR>&nbsp;&nbsp;&nbsp;above&nbsp;copyright&nbsp;notice,&nbsp;this&nbsp;list&nbsp;of&nbsp;conditions&nbsp;
<BR>&nbsp;&nbsp;&nbsp;and&nbsp;the&nbsp;following&nbsp;disclaimer.
<P>

2. Redistributions in binary form must reproduce
<BR>&nbsp;&nbsp;&nbsp;the&nbsp;above&nbsp;copyright&nbsp;notice,&nbsp;this&nbsp;list&nbsp;of&nbsp;con-
<BR>&nbsp;&nbsp;&nbsp;ditions&nbsp;and&nbsp;the&nbsp;following&nbsp;disclaimer&nbsp;in&nbsp;the
<BR>&nbsp;&nbsp;&nbsp;documentation&nbsp;and/or&nbsp;other&nbsp;materials&nbsp;provided&nbsp;
<BR>&nbsp;&nbsp;&nbsp;with&nbsp;the&nbsp;distribution.
<P>

THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
SUCH DAMAGE.
<A NAME="lbAN">&nbsp;</A>
<H2>CREDITS</H2>

Stefan Siebert for making the start of this project possible. Xiaodong Lin
with his excellent Opsec skills for helping me in further development of 
<B>fw1-loggrabber</B>.
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">PREREQUISITES</A><DD>
<DT><A HREF="#lbAF">OPTIONS</A><DD>
<DT><A HREF="#lbAG">CONFIGURATION FILE</A><DD>
<DT><A HREF="#lbAH">CONFIGURE FW-1</A><DD>
<DT><A HREF="#lbAI">FILTERING</A><DD>
<DT><A HREF="#lbAJ">FILES</A><DD>
<DT><A HREF="#lbAK">AUTHOR</A><DD>
<DT><A HREF="#lbAL">BUGS</A><DD>
<DT><A HREF="#lbAM">COPYRIGHT</A><DD>
<DT><A HREF="#lbAN">CREDITS</A><DD>
</DL>
<HR>
This document was created by
<A HREF="http://localhost/cgi-bin/man/man2html">man2html</A>,
using the manual pages.<BR>
Time: 10:00:56 GMT, September 14, 2004
</BODY>
</HTML>
